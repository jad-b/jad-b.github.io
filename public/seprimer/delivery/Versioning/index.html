<!DOCTYPE html>
<html>

  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=yes">

    <link rel="stylesheet" href="http://jad-b.github.io/css/stark.css">
    <link rel="stylesheet" href="http://jad-b.github.io/css/prism.css">
    <link rel="stylesheet" href="http://jad-b.github.io/css/font-awesome.min.css">
    <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Sorts+Mill+Goudy|Lato:100,300,400,600">

    
    
    <title>Versioning - while true: continue</title>
    <meta content=" - The education of a curious man." property="og:description">
    <meta content="Versioning - while true: continue" property="og:title">
    
      
      <meta content="software engineering" name="keywords">
      
    
    

  </head>

  <body>

    <header class="hero grid">
      <a class="logo" href="#">
        <p>while true:</p><p class="logo-continue">continue</p>
      </a>
    </header>

      
      <main class="site-content grid">


<article>

  <div class="grid content-title">

  
  <h1 class="cell">
    <a href="http://jad-b.github.io/seprimer/delivery/Versioning/"> Versioning </a>
  </h1>

  

  
  <p class="cell content-timestamp">Last updated on Tue, Dec 20, 2016</p>

</div>



<p class="content-keywords">software engineering</p>



  

  

<h1 id="versioning:5a4b99c21b081609fa42f039ef972d42">Versioning</h1>

<h2 id="key-points:5a4b99c21b081609fa42f039ef972d42">Key Points</h2>

<ul>
<li>Versions provide for human-readable ordering.</li>
<li>Checksums provide <em>equality</em>-operations.</li>
<li>Semantic Versioning is a great place to start. Use prerelease and build
information to customize as to your team&rsquo;s own practices.</li>
</ul>

<h2 id="versions-checksums:5a4b99c21b081609fa42f039ef972d42">Versions &amp; Checksums</h2>

<p>All of the Continuous Whatevers we&rsquo;re about to address is enabled by versioning,
and for a simple reason: Versioning provides <em>orderable</em> definition of state.
Without it, you simply <em>can not</em> efficiently reason changes to a codebase. And
if you don&rsquo;t know <em>what</em> was, is, and will be running, how could you possibly
understand what&rsquo;s going on in your codebase?</p>

<p>A related topic is <strong>checksums</strong>. A checksum is a hash of the contents of
file(s) that gives you an absolute reference point; if <em>anything</em> changes, the
checksum changes. This makes them fantastic for asking &ldquo;are these two things the
same?&ldquo;, but gives you no information regarding which came first. You could
extend a checksum with an auto-incrementing integer, providing a notion of
sequence, but your VCS is already doing this for you.</p>

<p>I&rsquo;ll posit that versions should be <em>human</em>-readable, for a simple reason: a
person is needed for input, and a human consumes the output.
The information conveyed by a semantic version regarding major, minor, or patch-level
changes must be provided by a human<sup class="footnote-ref" id="fnref:5a4b99c21b081609fa42f039ef972d42:1"><a rel="footnote" href="#fn:5a4b99c21b081609fa42f039ef972d42:1">1</a></sup>, and the output is a version
that <em>should</em> influence a human as to how code is deployed. Remember: automation
is doing what a human said to do, given certain input.</p>

<h2 id="how-to-version:5a4b99c21b081609fa42f039ef972d42">How to version</h2>

<p>Semantic Versioning has become a popular standard for versioning across
open-source projects. It&rsquo;s intuitive, it supplies a standard set of meanings,
and is sufficiently extendable to generalize across different product&rsquo;s use
cases. As such, it&rsquo;s the basis of what I&rsquo;ll propose here.</p>

<p>Given a version such as <code>Major.Minor.Patch</code>, it breaks down to:</p>

<ul>
<li><code>Major</code>: API-breaking changes.</li>
<li><code>Minor</code>: New functionality.</li>
<li><code>Patch</code>: Bug fixes.</li>
</ul>

<p><code>Patch</code> &lt; <code>Minor</code> &lt; <code>Major</code>, as far as ordering goes. If you bump the version by
<code>Major</code>, you zero out <code>Minor</code> and <code>Patch</code>; bump by a <code>Minor</code>, zero just <code>Patch</code>.
Simple. You start with <code>0.1.0</code> as your first commit, and go to 1.0.0 when
you&rsquo;re used by customers in production, your API has stabilized, or you already
have concerns about backwards compatbility.</p>

<h3 id="extending-the-version-for-stages-of-development:5a4b99c21b081609fa42f039ef972d42">Extending the Version for Stages of Development</h3>

<p>Few of us write code on production machines that live-reload the daemon every
time you hit save. We can consider any and all verifications and
validations<sup class="footnote-ref" id="fnref:5a4b99c21b081609fa42f039ef972d42:2"><a rel="footnote" href="#fn:5a4b99c21b081609fa42f039ef972d42:2">2</a></sup> as &ldquo;stages&rdquo; in a code change. With that rough definition, we can
easily imagine the following checks in committing a change to a web server:</p>

<ol>
<li>Code builds, unit tests and static code analysis pass.</li>
<li>Functional tests pass against the server</li>
<li>Code deploys to a test environment &amp; acceptance tests pass</li>
<li>Code deploys to a staging environment &amp; acceptance tests pass</li>
<li>Code deploys to production &amp; acceptance tests pass</li>
</ol>

<p>And each stage can itself be composed of stages. Take the first step of building
code; it could go across multiple components, libraries, and even languages.
Unit tests exist for each component, and could have certain criteria for
coverage.  Static code analysis tooling could be anything from &ldquo;best practice&rdquo;
checks to dead code finders to static type checkers to AST optimizers to
what-have-you.</p>

<p>Point is, you may want to have your version indicate <em>where</em> it is in this
gauntlet of quality control. Fortunately, SemVer provides for this through the
use of a <code>-</code> followed by any number of <code>.</code>-separated identifiers: <code>-alpha</code>,
<code>-dev3.rc1</code>, <code>a1.b2.c3</code>, etc. Let&rsquo;s say your team has three significantly
meaningful stages in your CI pipeline: I Changed Something (Local), Worked On My
Box (commit), Works Against Other People&rsquo;s Code (Integration), Works Against
Production (Staging). Let&rsquo;s assume the last tagged version was 1.2.3, and we
have a <code>minor</code> change worth of changes queued up. We could denote their
successful passage using extensions such as:</p>

<ul>
<li>Local:  1.3.0-local3+abc123 (Three commits past 1.2.3, read on for an
explanation of the <code>+abc123</code>)</li>
<li>Commit:  1.3.0-dev3</li>
<li>Integration: 1.3.0-int3</li>
<li>Staging: 1.3.0-stage3</li>
<li>Production: 1.3.0</li>
</ul>

<p>Note that we immediately go to <code>1.3.0</code>. Since only the <code>master</code> branch is tested
through our deployments, the pre-release modifiers uniquely identify which point
in <code>master</code>&rsquo;s history we&rsquo;re talking about.</p>

<p>Since everyone&rsquo;s environments and practices will be different, you <strong>must</strong>
evaluate the important stages of your own team&rsquo;s development, and create your
own version extensions. Discuss it as a team, as ambiguity in a version defeats
its purpose.</p>

<p>What about the <code>+abc123</code>? That&rsquo;s a <strong>build identifier</strong>. When we&rsquo;re working
locally, your three commits past 1.2.3 will look different than my three
commits past 1.2.3. We can differentiate between the two using the build
information; in this, a selection of git&rsquo;s SHA1 commit hash works well. When we
commit to <code>master</code>, our work is forced to become ordered, and we no longer have
a version conflict. Build identifiers are useful for differentiating on
operations <em>outside</em> of the code; repeated builds on your CI server come to
mind, perhaps during debugging or troubleshooting dependent services.</p>

<h2 id="versioning-and-test-driven-development-a-good-match:5a4b99c21b081609fa42f039ef972d42">Versioning and Test-Driven Development: A Good Match</h2>

<p>We know what a version should <em>mean</em>, and how its pieces compose to convey that
meaning. But real life is messy, and exactly <em>when</em> a version-worthy change goes
into effect can be messy. I propose a simple test that enforces good habits: A
change goes into effect when its corresponding test(s) passes. Simple, clear,
and meaningful.</p>

<h2 id="putting-it-into-practice:5a4b99c21b081609fa42f039ef972d42">Putting it into practice</h2>

<p>Write your code. When you go to commit your work into git, include metadata
within the commit message indicating what the work is for (work ticket number,
associated project ID, whatever). When the flagship test for your
feature-change/bug-fix passes, you cut your version. Even better, you include a
machine-readable directive within your commit message that tells your
auto-versioning function/build step/CI job to version <em>for</em> you.</p>

<h2 id="resources:5a4b99c21b081609fa42f039ef972d42">Resources</h2>

<ul>
<li><a href="https://semver.org">SemVer</a></li>
<li>A SemVer-compatible SemVer enabler: <a href="https://github.com/pypa/setuptools_scm">setuptools_scm</a></li>
</ul>
<div class="footnotes">

<hr />

<ol>
<li id="fn:5a4b99c21b081609fa42f039ef972d42:1">As of today.
 <a class="footnote-return" href="#fnref:5a4b99c21b081609fa42f039ef972d42:1"><sup>[return]</sup></a></li>

<li id="fn:5a4b99c21b081609fa42f039ef972d42:2"><p>Yep, those are two different things:
<a href="https://en.wikipedia.org/wiki/Software_verification_and_validation">https://en.wikipedia.org/wiki/Software_verification_and_validation</a></p>
 <a class="footnote-return" href="#fnref:5a4b99c21b081609fa42f039ef972d42:2"><sup>[return]</sup></a></li>
</ol>
</div>


</article>

<div id="disqus_thread"></div>
<script>
   var disqus_config = function () {
     this.page.url = "http:\/\/jad-b.github.io\/seprimer\/delivery\/Versioning\/";
     
   };

  
  (function() {
    
    
    if (window.location.hostname == "localhost")
        return;

    var d = document, s = d.createElement('script');

    s.src = "//while-true-continue.disqus.com/embed.js";

    s.setAttribute('data-timestamp', + new Date());
    (d.head || d.body).appendChild(s);
  })();
</script>

<noscript>Please enable JavaScript to view the
  <a href="https://disqus.com/?ref_noscript" rel="nofollow">
    comments powered by Disqus.
  </a>
</noscript>


  </main>

    <footer>

      <span class="copyright">
        <i class="fa fa-copyright"></i>
        <a href="j.american.db@gmail.com">j.american.db@gmail.com</a>
      </span>


      <span class="profile-links">

        
        <a href="https://github.com/jad-b">
          <img alt="jad-b @ GitHub"
               src="http://jad-b.github.io/img/octocat.svg"
               width="32"
               height="32">
        </a>

        
        <a href="https://www.goodreads.com/user/show/43556621-jeremy-dobbins-bucklad">
          <img alt="Goodreads"
               src="https://www.goodreads.com/assets/layout/header/nav_g_icon.svg"
               width="32"
               height="32">
        </a>

        
        <iframe allowtransparency="true" scrolling="no" frameborder="no"
          src="https://w.soundcloud.com/icon/?url=http%3A%2F%2Fsoundcloud.com%2Fjeremy-dobbins-bucklad&color=orange_white&size=32"
          style="width: 32px; height: 32px;"></iframe>

        
        <a href="http://8tracks.com/herbert-finkleton">
          <img alt="8Tracks"
               src="http://images.8tracks.com/avatar/i/006/193/171/52608.original-3203.jpg?rect=0,0,500,500&q=98&fm=jpg&fit=max&w=56&h=56"
               width="32"
               height="32">
        </a>
      </span> 

    </footer>

  
<script src="http://jad-b.github.iojs/prism.js" async></script>

<script type="text/javascript" src="http://jad-b.github.iojs/MathJax.js" async></script>
<script type="text/x-mathjax-config" defer>


MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    displayMath: [['$$','$$'], ['\[','\]']],
    processEscapes: true,
    processEnvironments: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
    TeX: { equationNumbers: { autoNumber: "AMS" },
         extensions: ["AMSmath.js", "AMSsymbols.js"] }
  }
});
</script>

<script type="text/x-mathjax-config" defer>
  
  
  
  MathJax.Hub.Queue(function() {
    
    
    
    var all = MathJax.Hub.getAllJax(), i;
    for(i = 0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
    }
});
</script>


<script id="dsq-count-scr" src="//while-true-continue.disqus.com/count.js" async></script>

  </body>

</html>

